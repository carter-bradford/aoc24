# Cut and paste from library for simplicity
NN â† (>âŸœÂ«0âŠ¸â‰¤) / 0(0âŠ¸â‰¤Ã—Ã—âŸœ10âŠ¸+)`âŠ¢

ToNums â† {
  Tâ†âŒˆ`Ã— â‹„ I1Tâ†(1+â†•âˆ˜â‰ )âŠ¸T
  cdâ†â‰ digâ†('0'+â†•10)âˆ¾"Ï€âˆ" â‹„ valâ†(â†•10)âˆ¾Ï€â€¿1â€¿Â¯1 # âˆ as 1 to avoid âˆÃ—0
  eâ€¿dâ€¿nâ€¿pâ€¿iâ†"e.Â¯Ï€âˆ"=<ğ•© â‹„ eâ€¿nâˆ¨â†©"E-"=<ğ•©
  mâ†cd>jâ†digâŠğ•© â‹„ dâ€¿eâ€¿nâˆ§â†©(Â»(âˆ¨<âŠ¸âˆ¾âˆ§â‹ˆâŠ¢)Â«)nâˆ¨mâˆ¨d â‹„ mâˆ¨â†©d
  sâ†dâˆ¨câ†eâˆ¨zâ†(trâ†âˆ§`âŒ¾âŒ½zz)<Â»âŠ¸<zzâ†Â¬eâˆ¨nâˆ¨m
  "Negative sign in the middle of a number"! âˆ§Â´nâ‰¤1Â»zzâˆ¨c
  "Portion of a number is empty"! âˆ§Â´Â¬(1Â«sâˆ¨tr)âˆ§nâˆ¨s
  "Ill-formed decimal or exponent use"! âˆ§Â´(0âŠ¸=âˆ¨Â»âŠ¸<)s/d+2Ã—e
  "Ï€ and âˆ must occur alone"! âˆ§Â´(pâˆ¨i)â‰¤1(Â»âˆ§(pâˆ§Â«e)âˆ¨Â«)zzâˆ¨n>Â»e
  lâ†(Â¬(âŠ¢-T)Â·+`dâŠ¸<)gâ†(Â«â‰¤(d<jzâ†jâ‰ 0)>â—‹I1TÂ¬)âŠ¸âˆ§m # No leading 0s
  laâ†dÃ—(Â»Â¬(âŠ¢-T)+`)âŒ¾âŒ½Â¬gâˆ¨jz                   # Adjust dp for dropped 0s after decimal
  kâ€¿dpâ†dÂ¬âŠ¸(/â‹ˆ1âŠ¸Â»âŠ¸/)â—‹((dâˆ¨>âŸœÂ«g)âŠ¸/)l-la        # Length, decimal position
  PNâ†NN valâŠËœ(Â«âŠ¸>âˆ¨dâŠ¸<)/jâŒˆcdÃ—Â¬
  vaâ†{                                      # Numeric valuesâ€”mantissas and exponents
    Â¬âˆ¨Â´k>15?PN g;                           # If >15 digits anywhere:
    gâˆ§â†©20â‰¥lâ‹„kâŒŠâ†©20                           # Cap at 20 digits
    g>â†©fâ†gâˆ§lâ‰¤(+`Â»âŠ¸<g)âŠ0âˆ¾teâ†0âŒˆk-15           # Handle trailing â‰¤15 normally
    (1e15Ã—PN f)âŠ¸+âŒ¾((te>0)âŠ¸/) PN g           # Leading part
  }
  vâ†vaÃ—1â€¿Â¯1âŠËœ(râ†>âŸœÂ»m)/Â»n                    # Negate if Â¯
  vmâ†c/â—‹(1âŒ¾âŠ‘)z                              # Mask of mantissas in v
  mnâ†vm/vÃ—(r/i)âŠ1â€¿âˆ                         # Mantissa, correcting âˆ
  eeâ†vm/(k-dp)-ËœÂ«vÃ—Â¬vm                      # Power of 10
  aâ†(0âŒˆee)+ee-bâ†eeâŒˆÂ¯308                     # Subnormal handling
  bÃ·âŸœ(10â‹†-)ËœâŒ¾((0>b)âŠ¸/)a 10âŠ¸â‹†âŠ¸Ã—âŒ¾((0â‰ a)âŠ¸/)mn  # mnÃ—10â‹†ee
}
# End of cut and paste

i â† â€¢file.Lines "../levels.txt"

r â† ToNumsÂ¨i

Ord â† âˆ§âŠ¸(â‰¡âˆ¨â‰¡âŸœâŒ½)
Dif â† âˆ§Â´1=1â€¿4â‹Â·|Â¯1â†“-âŸœÂ«
Safe â† Difâˆ§Ord

â€¢Show p1 â† +Â´ s â† SafeÂ¨r

r /Ëœâ†© Â¬s
â€¢Show p1 +Â´(âˆ¨Â´Â·SafeË˜âŠ¢/â‰1ËœÂ·â‰ âŒœËœÂ·â†•â‰ )Â¨r